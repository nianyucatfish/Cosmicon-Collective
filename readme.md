# 《崩坏：星穹铁道》银河战力党卡牌效果 web 复现

本项目基于 vibe coding（Gemini 太好用了！！！） + Three.js 开发。支持 PC 端鼠标视差悬浮与移动端陀螺仪/触摸交互，实现了非矩形遮罩、动态全息炫光边框以及高性能的 3D 穿插软边缘羽化效果。

## 文件组织

项目目录结构如下：

```text
├── index.html                  # 主入口文件（包含所有逻辑与着色器）
└── asset/                      # 静态资源目录
    ├── card-border-mask.png    # 边框透明度遮罩图
    ├── stencil-mask.png        # Stencil 模板挖孔遮罩图
    └── liuying/                # 角色文件夹
        ├── background.png      # 卡牌底层背景
        ├── character.png       # 角色立绘（带透明通道）
        ├── description.png     # 底部描述文字
        └── value.png           # 战力数值图
```

## 核心实现原理
1. 层级元素布置：从后往前依次是：背景层 + 角色层 + 文本描述 + 卡牌边框 + 数值 + 卡面纹理效果。角色层前倾，使得下半部分在边框内，上办部分在边框外。

2. Stencil Buffer 遮罩
为了防止角色和背景超出卡牌边界，将所有层级压成一张牌，项目采用了 WebGL 原生的模板缓冲技术。

开洞 (写模板)：创建一个不可见的 stencilMesh，其材质配置为 stencilWrite: true 和 AlwaysStencilFunc。它在场景最先渲染（renderOrder = -1），并在屏幕上属于卡牌的区域打上标记（Stencil Ref = 1）。

读取 (用模板)：卡牌的背景、文字等组件配置为 EqualStencilFunc。GPU 在渲染这些层时，会自动丢弃标记不为 1 的像素，从而实现完美的高性能异形裁剪，同时允许角色层无视模板，自由“跃出”卡面。

3. 金属边框
金属质感通过色带的流动实现。

4. 3D 软交线羽化
当角色前倾时，角色平面与边框平面在 3D 空间会发生硬穿插。为了让交线自然过渡，在边框的 Shader 中实现了一套“软边缘”剔除逻辑。
